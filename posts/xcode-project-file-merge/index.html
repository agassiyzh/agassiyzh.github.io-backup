<!doctype html><html lang=zn-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="小於"><title>xcode project file merge ｜ 小於的宅基地</title><meta name=description content="在多人协作完成iOS项目的时候总是会遇到*.pbxproj文件冲突的情况。很不幸这个文件是那么的重要但是这次XCode5更新中又没有对其改进（xib解决得多好，期待在下个本版中又改进吧）。我有一个项目的这个文件已经达到了6w多行。
 The issue with XCode (not sure about Visual Studio) is that .pbxproj files are barely human-readable, so it doesn&amp;rsquo;t make sense to resolve conflicts by hand.
blockquote Tom
 就像这个@Tom老兄说的那样这个*.pbxproj不是给人类读的！所以手工来解决冲突太费劲了。我曾经尝试过几次。但是以后再也不会想要再试了的。"><meta name=keywords content="技术,园艺,Iot,生活,感悟,育儿"><link rel="shortcut icon" href=http://localhost:1313/images/favicon.ico><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/zozo.css><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/customize.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/highlight.css></head><body><div class="main animate__animated animate__fadeInDown"><div class="nav_container animated fadeInDown"><div class=site_nav id=site_nav><ul><li><a href=/>Home</a></li><li><a href=/posts/>Archive</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li></ul></div><div class=menu_icon><a id=menu_icon><i class=ri-menu-line></i></a></div></div><div class="header animated fadeInDown"><div class=site_title_container><div class=site_title><h1><a href=http://localhost:1313/><span>小於的宅基地</span></a></h1></div><div class=description><p class=sub_title>但愿每次回忆都不觉愧疚</p><div class=my_socials><a href=https://github.com/agassiyzh title=github target=_blank><i class=ri-github-fill></i></a><a href=https://twitter.com/agassi_yzh title=twitter target=_blank><i class=ri-twitter-fill></i></a><a href=http://localhost:1313/index.xml type=application/rss+xml title=rss target=_blank><i class=ri-rss-fill></i></a></div></div></div></div><div class=content><div class=post_page><div class="post animate__animated animate__fadeInDown"><div class="post_title post_detail_title"><h2><a href=/posts/xcode-project-file-merge/>xcode project file merge</a></h2><span class=date>2013.09.03</span></div><div class="post_content markdown"><p>在多人协作完成iOS项目的时候总是会遇到<code>*.pbxproj</code>文件冲突的情况。很不幸这个文件是那么的重要但是这次XCode5更新中又没有对其改进（xib解决得多好，期待在下个本版中又改进吧）。我有一个项目的这个文件已经达到了6w多行。</p><blockquote><p>The issue with XCode (not sure about Visual Studio) is that .pbxproj files are barely human-readable, so it doesn&rsquo;t make sense to resolve conflicts by hand.</p><p><em><a href="https://stackoverflow.com/questions/2615378/how-to-use-git-properly-with-xcode?answertab=active#comment2626908_2615378">blockquote Tom</a></em></p></blockquote><p>就像这个@Tom老兄说的那样这个<code>*.pbxproj</code>不是给人类读的！所以手工来解决冲突太费劲了。我曾经尝试过几次。但是以后再也不会想要再试了的。</p><p>那么有什么比<em>较好</em>的方法来解决这个问题呢？</p><p>在<a href="https://stackoverflow.com/questions/2615378/how-to-use-git-properly-with-xcode?answertab=active#tab-top">Stackoverflow的这个回答中我找到了答案</a>。</p><h2 id=方法一>方法一</h2><p>编写一个脚本:</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell><span class=cp>#!/bin/sh
</span><span class=cp></span>
<span class=nv>projectfile</span><span class=o>=</span><span class=sb>`</span>find -d . -name <span class=s1>&#39;project.pbxproj&#39;</span><span class=sb>`</span>
<span class=nv>projectdir</span><span class=o>=</span><span class=sb>`</span><span class=nb>echo</span> *.xcodeproj<span class=sb>`</span>
<span class=nv>projectfile</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>projectdir</span><span class=si>}</span><span class=s2>/project.pbxproj&#34;</span>
<span class=nv>tempfile</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>projectdir</span><span class=si>}</span><span class=s2>/project.pbxproj.out&#34;</span>
<span class=nv>savefile</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>projectdir</span><span class=si>}</span><span class=s2>/project.pbxproj.mergesave&#34;</span>

cat <span class=nv>$projectfile</span> <span class=p>|</span> grep -v <span class=s2>&#34;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD&#34;</span> <span class=p>|</span> grep -v <span class=s2>&#34;=======&#34;</span> <span class=p>|</span> grep -v <span class=s2>&#34;^&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#34;</span> &gt; <span class=nv>$tempfile</span>
cp <span class=nv>$projectfile</span> <span class=nv>$savefile</span>
mv <span class=nv>$tempfile</span> <span class=nv>$projectfile</span>
</code></pre></div><h2 id=方法二>方法二</h2><p>在<code>.gitattributes</code>中添加下面这句:</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>*.pbxproj text -crlf -diff -merge<span class=o>=</span>union
</code></pre></div><p>其实方法一和方法二的做法是一样的。都是单纯把merge产生的<code>&lt;&lt;&lt;&lt;&lt;</code>,<code>======</code>,<code>>>>>>></code>删掉罢了。只不过是第一种需要每次merge以后手工执行脚本，第二种写成了git的配置自动执行并且在diff的时候不会看到*.xcodeproj相关的信息，git会把它当作二进制文件来处理。</p><p>我推荐使用第二种方法。</p><p>这样有99%的情况，可以解决merge的问题。剩下的1%。只能用土方法了。取出线上没问题的文件，然手工添加。</p><p>当然了，也可以人肉merge，今天我用vim的%查找匹配的<code>{</code>和<code>}</code>。可以比较快速的定位，从最后一个<code>}</code>开始查找。</p></div><div class=post_footer><div class=meta><div class=info><span class="field tags"><i class=ri-stack-line></i><a href=http://localhost:1313/tags/xcode/>xcode</a>
<a href=http://localhost:1313/tags/git/>git</a></span></div></div></div></div><div class=doc_comments></div></div></div></div><a id=back_to_top href=# class=back_to_top><i class=ri-arrow-up-s-line></i></a><footer class=footer><div class=powered_by><a href=https://varkai.com>Designed by VarKai,</a>
<a href=http://www.gohugo.io/>Proudly published with Hugo</a></div><div class=footer_slogan><span>人生没有白走的路，每一步都算数</span></div></footer><script src=http://localhost:1313/js/jquery-3.5.1.min.js></script><link href=http://localhost:1313/css/fancybox.min.css rel=stylesheet><script src=http://localhost:1313/js/fancybox.min.js></script><script src=http://localhost:1313/js/zozo.js></script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\[\[','\]\]']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></body></html>